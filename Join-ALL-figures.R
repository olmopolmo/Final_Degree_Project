setwd("/Users/ASUS/Desktop/BIOINFO/PRBB/Training_Dataset/PAPER_dataset_creation/")
fig2<-read.csv("fig2e_fastqs-info.csv")
fig4<-read.csv("fig4_fastqs-info.csv")
fig10<-read.csv("fig10_fastqs-info.csv")

Run<-c(fig2$Run,fig4$Run,fig10$Run)
gRNA<-c(toupper(fig2$spacer),fig4$gRNA,fig10$gRNA)
template<-c(toupper(fig2$template),fig4$template,fig10$template)
titles <- c(toupper(fig2$Sample),fig4$Experiment.Title,fig10$Experiment.Title)
All_figures<-data.frame(Run,gRNA,template,titles)

strings <- paste("['",All_figures$Run[indexes],"','",All_figures$gRNA[indexes],"'],",sep = "")
data.frame(strings)

write.csv(strings, file = "textooooo.txt")
j=0
setwd("/Users/ASUS/Desktop/BIOINFO/PRBB/Training_Dataset/PAPER_dataset_creation/TRUE_DATASET/Templates/")
for (i in 1:length(actual)){
  SRR <- All_figures$Run[which(All_figures$Run == actual[i])]
  temp <- All_figures$template[which(All_figures$Run == actual[i])]
  if(length(SRR)==1){
    print(i)
    write.fasta(as.string = T,sequences =temp[1], open = "w",names = SRR[1], file.out = paste(SRR[1],".fasta",sep = "")) 
  }
}

z<- intersect(actual,Run)
indexes <- match(z,Run)

unique(All_figures$gRNA)

actual <- c("SRR10286462",
  "SRR10286463",
  "SRR10286464",
  "SRR10286465",
  "SRR10286469",
  "SRR10286470",
  "SRR10286471",
  "SRR10286473",
  "SRR10286474",
  "SRR10286475",
  "SRR10286476",
  "SRR10286477",
  "SRR10286478",
  "SRR10286479",
  "SRR10286480",
  "SRR10286481",
  "SRR10286482",
  "SRR10286483",
  "SRR10286484",
  "SRR10286485",
  "SRR10286486",
  "SRR10286487",
  "SRR10286488",
  "SRR10286489",
  "SRR10286490",
  "SRR10286491",
  "SRR10286492",
  "SRR10286493",
  "SRR10286494",
  "SRR10286498",
  "SRR10286499",
  "SRR10286500",
  "SRR10286501",
  "SRR10286502",
  "SRR10286503",
  "SRR10286504",
  "SRR10286505",
  "SRR10286506",
  "SRR10286507",
  "SRR10286508",
  "SRR10286509",
  "SRR10286510",
  "SRR10286511",
  "SRR10286512",
  "SRR10286513",
  "SRR10286514",
  "SRR10286515",
  "SRR10286516",
  "SRR10286517",
  "SRR10286518",
  "SRR10286519",
  "SRR10286520",
  "SRR10286521",
  "SRR10286522",
  "SRR10286523",
  "SRR10286524",
  "SRR10286525",
  "SRR10286526",
  "SRR10286527",
  "SRR10286528",
  "SRR10286529",
  "SRR10286530",
  "SRR10286534",
  "SRR10286535",
  "SRR10286537",
  "SRR10286538",
  "SRR10286539",
  "SRR10286540",
  "SRR10286541",
  "SRR10286542",
  "SRR10286543",
  "SRR10286544",
  "SRR10286545",
  "SRR10286546",
  "SRR10286547",
  "SRR10286548",
  "SRR10286549",
  "SRR10286550",
  "SRR10286551",
  "SRR10286552",
  "SRR10286553",
  "SRR10286554",
  "SRR10286555",
  "SRR10286556",
  "SRR10286557",
  "SRR10286558",
  "SRR10286559",
  "SRR10286560",
  "SRR10286561",
  "SRR10286562",
  "SRR10286563",
  "SRR10286564",
  "SRR10286565",
  "SRR10286566",
  "SRR10286567",
  "SRR10286568",
  "SRR10286569",
  "SRR10286570",
  "SRR10286571",
  "SRR10286572",
  "SRR10286573",
  "SRR10286574",
  "SRR10286575",
  "SRR10286576",
  "SRR10286577",
  "SRR10286578",
  "SRR10286579",
  "SRR10286580",
  "SRR10286581",
  "SRR10286582",
  "SRR10286583",
  "SRR10286584",
  "SRR10286585",
  "SRR10286586",
  "SRR10286587",
  "SRR10286588",
  "SRR10286589",
  "SRR10286590",
  "SRR10286591",
  "SRR10286592",
  "SRR10286593",
  "SRR10286594",
  "SRR10286595",
  "SRR10286596",
  "SRR10286597",
  "SRR10286598",
  "SRR10286599",
  "SRR10286603",
  "SRR10286604",
  "SRR10286605",
  "SRR10286606",
  "SRR10286607",
  "SRR10286608",
  "SRR10286609",
  "SRR10286610",
  "SRR10286611",
  "SRR10286612",
  "SRR10286613",
  "SRR10286614",
  "SRR10286615",
  "SRR10286616",
  "SRR10286617",
  "SRR10286618",
  "SRR10286619",
  "SRR10286620",
  "SRR10286621",
  "SRR10286622",
  "SRR10286626",
  "SRR10286627",
  "SRR10286628",
  "SRR10286629",
  "SRR10286630",
  "SRR10286631",
  "SRR10286632",
  "SRR10286633",
  "SRR10286634",
  "SRR10286635",
  "SRR10286636",
  "SRR10286637",
  "SRR10286638",
  "SRR10286639",
  "SRR10286640",
  "SRR10286641",
  "SRR10286642",
  "SRR10286643",
  "SRR10286644",
  "SRR10286645",
  "SRR10286649",
  "SRR10286650",
  "SRR10286651",
  "SRR10286652",
  "SRR10286654",
  "SRR10286655",
  "SRR10286656",
  "SRR10286660",
  "SRR10286661",
  "SRR10286662",
  "SRR10286663",
  "SRR10286664",
  "SRR10286666",
  "SRR10286667",
  "SRR10286668",
  "SRR10286669",
  "SRR10286670",
  "SRR10286671",
  "SRR10286672",
  "SRR10286673",
  "SRR10286674",
  "SRR10286675",
  "SRR10286677",
  "SRR10286678",
  "SRR10286679",
  "SRR10286683",
  "SRR10286684",
  "SRR10286685",
  "SRR10286686",
  "SRR10286687",
  "SRR10286688",
  "SRR10286689",
  "SRR10286690",
  "SRR10286691",
  "SRR10286692",
  "SRR10286693",
  "SRR10286694",
  "SRR10286695",
  "SRR10286696",
  "SRR10286697",
  "SRR10286698",
  "SRR10286699",
  "SRR10286700",
  "SRR10286701",
  "SRR10286702",
  "SRR10286706",
  "SRR10286707",
  "SRR10286708",
  "SRR10286709",
  "SRR10286710",
  "SRR10286711",
  "SRR10286712",
  "SRR10286716",
  "SRR10286717",
  "SRR10286718",
  "SRR10286719",
  "SRR10286720",
  "SRR10286721",
  "SRR10286722",
  "SRR10286723",
  "SRR10286724",
  "SRR10286725",
  "SRR10286726",
  "SRR10286727",
  "SRR10286728",
  "SRR10286729",
  "SRR10286730",
  "SRR10286731",
  "SRR10286732",
  "SRR10286733",
  "SRR10286734",
  "SRR10286735",
  "SRR10286739",
  "SRR10286740",
  "SRR10286741",
  "SRR10286742",
  "SRR10286743",
  "SRR10286744",
  "SRR10286745",
  "SRR10286746",
  "SRR10286747",
  "SRR10286748",
  "SRR10286749",
  "SRR10286750",
  "SRR10286751",
  "SRR10286752",
  "SRR10286754",
  "SRR10286755",
  "SRR10286756",
  "SRR10286757",
  "SRR10286758",
  "SRR10286762",
  "SRR10286763",
  "SRR10286765",
  "SRR10286766",
  "SRR10287764",
  "SRR10287765",
  "SRR10287766",
  "SRR10287767",
  "SRR10287768",
  "SRR10287769",
  "SRR10287770",
  "SRR10287771",
  "SRR10287772",
  "SRR10287773",
  "SRR10287774",
  "SRR10287775",
  "SRR10287776",
  "SRR10287777",
  "SRR10287778",
  "SRR10287779",
  "SRR10287780",
  "SRR10287781",
  "SRR10287782",
  "SRR10287783",
  "SRR10287784",
  "SRR10287785",
  "SRR10287786",
  "SRR10287787",
  "SRR10287788",
  "SRR10287789",
  "SRR10287790",
  "SRR10287791",
  "SRR10287792",
  "SRR10287793",
  "SRR10287794",
  "SRR10287795",
  "SRR10287796",
  "SRR10287797",
  "SRR10287798",
  "SRR10287799",
  "SRR10287800",
  "SRR10287801",
  "SRR10287802",
  "SRR10287803",
  "SRR10287804",
  "SRR10287805",
  "SRR10287806",
  "SRR10287807",
  "SRR10287808",
  "SRR10287809",
  "SRR10287810",
  "SRR10287811",
  "SRR10287812",
  "SRR10287813",
  "SRR10287814",
  "SRR10287815",
  "SRR10287816",
  "SRR10287817",
  "SRR10287818",
  "SRR10287819",
  "SRR10287820",
  "SRR10287821",
  "SRR10287822",
  "SRR10287823",
  "SRR10287824",
  "SRR10287825",
  "SRR10287826",
  "SRR10287827",
  "SRR10287828",
  "SRR10287829",
  "SRR10287830",
  "SRR10287831",
  "SRR10287832",
  "SRR10287833",
  "SRR10287834",
  "SRR10287835",
  "SRR10287836",
  "SRR10287837",
  "SRR10287838",
  "SRR10287839",
  "SRR10287840",
  "SRR10287841",
  "SRR10287842",
  "SRR10287843",
  "SRR10287844",
  "SRR10287845",
  "SRR10287846",
  "SRR10287847",
  "SRR10287848",
  "SRR10287849",
  "SRR10287850",
  "SRR10287851",
  "SRR10287852",
  "SRR10287853",
  "SRR10287854",
  "SRR10287855",
  "SRR10287856",
  "SRR10287857",
  "SRR10287858",
  "SRR10287859",
  "SRR10287860",
  "SRR10287861",
  "SRR10287862",
  "SRR10287863",
  "SRR10287864",
  "SRR10287865",
  "SRR10287866",
  "SRR10287867",
  "SRR10287868",
  "SRR10287869",
  "SRR10287870",
  "SRR10287871",
  "SRR10287872",
  "SRR10287873",
  "SRR10287874",
  "SRR10287875",
  "SRR10287876",
  "SRR10287877",
  "SRR10287878",
  "SRR10287879",
  "SRR10287880",
  "SRR10287881",
  "SRR10287882",
  "SRR10287883",
  "SRR10287884",
  "SRR10287885",
  "SRR10287886",
  "SRR10287887",
  "SRR10287888",
  "SRR10287889",
  "SRR10287890",
  "SRR10287891",
  "SRR10287892",
  "SRR10287893",
  "SRR10287894",
  "SRR10287895",
  "SRR10287896",
  "SRR10287897",
  "SRR10287898",
  "SRR10287899",
  "SRR10287900",
  "SRR10287901",
  "SRR10287902",
  "SRR10287903",
  "SRR10287904",
  "SRR10287905",
  "SRR10287906",
  "SRR10287907",
  "SRR10287908",
  "SRR10287909",
  "SRR10287910",
  "SRR10287911",
  "SRR10287912",
  "SRR10287913",
  "SRR10287914",
  "SRR10287915",
  "SRR10287916",
  "SRR10287917",
  "SRR10287918",
  "SRR10287919",
  "SRR10287920",
  "SRR10287921",
  "SRR10287922",
  "SRR10287923",
  "SRR10287924",
  "SRR10287925",
  "SRR10287926",
  "SRR10287927",
  "SRR10287928",
  "SRR10287929",
  "SRR10287930",
  "SRR10287931",
  "SRR10287932",
  "SRR10287933",
  "SRR10287934",
  "SRR10287935",
  "SRR10287936",
  "SRR10287937",
  "SRR10287938",
  "SRR10287939",
  "SRR10287940",
  "SRR10287941",
  "SRR10287942",
  "SRR10287943",
  "SRR10287944",
  "SRR10287945",
  "SRR10287946",
  "SRR10287947",
  "SRR10287948",
  "SRR10287949",
  "SRR10287950",
  "SRR10287951",
  "SRR10287952",
  "SRR10287953",
  "SRR10287954",
  "SRR10287955",
  "SRR10287956",
  "SRR10287957",
  "SRR10287958",
  "SRR10287959",
  "SRR10287960",
  "SRR10287961",
  "SRR10287962",
  "SRR10287963",
  "SRR10287964",
  "SRR10287965",
  "SRR10287966",
  "SRR10287967",
  "SRR10287968",
  "SRR10287969",
  "SRR10287970",
  "SRR10287971",
  "SRR10287972",
  "SRR10287973",
  "SRR10287974",
  "SRR10287975",
  "SRR10287986",
  "SRR10287987",
  "SRR10287998",
  "SRR10288009",
  "SRR10288020",
  "SRR10288031",
  "SRR10288036",
  "SRR10288037",
  "SRR10288038",
  "SRR10288039",
  "SRR10288040",
  "SRR10288041",
  "SRR10288042",
  "SRR10288043",
  "SRR10288044",
  "SRR10288045",
  "SRR10288046",
  "SRR10288047",
  "SRR10288048",
  "SRR10288049",
  "SRR10288050",
  "SRR10288051",
  "SRR10288052",
  "SRR10288053",
  "SRR10288054",
  "SRR10288055",
  "SRR10288056",
  "SRR10288057",
  "SRR10288058",
  "SRR10288059",
  "SRR10288060",
  "SRR10288061",
  "SRR10288062",
  "SRR10288063",
  "SRR10288064",
  "SRR10288065",
  "SRR10288066",
  "SRR10288067",
  "SRR10288068",
  "SRR10288069",
  "SRR10288070",
  "SRR10288071",
  "SRR10288072",
  "SRR10288073",
  "SRR10288074",
  "SRR10288075",
  "SRR10288076",
  "SRR10288077",
  "SRR10288078",
  "SRR10288079",
  "SRR10288080",
  "SRR10288081",
  "SRR10288082",
  "SRR10288083",
  "SRR10288084",
  "SRR10288085",
  "SRR10288086",
  "SRR10288087",
  "SRR10288088",
  "SRR10288089",
  "SRR10288090",
  "SRR10288091",
  "SRR10288092",
  "SRR10288093",
  "SRR10288094",
  "SRR10288095",
  "SRR10288096",
  "SRR10288097",
  "SRR10288098",
  "SRR10288099",
  "SRR10288100",
  "SRR10288101",
  "SRR10288102",
  "SRR10288103",
  "SRR10288104",
  "SRR10288105",
  "SRR10288106",
  "SRR10288107",
  "SRR10288108",
  "SRR10288109",
  "SRR10288110",
  "SRR10288111",
  "SRR17171765",
  "SRR17171766",
  "SRR17171767",
  "SRR17171768",
  "SRR17171770",
  "SRR17171771",
  "SRR17171772",
  "SRR17171773",
  "SRR17171774",
  "SRR17171775",
  "SRR17171776",
  "SRR17171777",
  "SRR17171778",
  "SRR17171779",
  "SRR17171782",
  "SRR17171783",
  "SRR17171784",
  "SRR17171785",
  "SRR17171786",
  "SRR17171787",
  "SRR17171788",
  "SRR17171789",
  "SRR17171790",
  "SRR17171791")

setwd("/Users/ASUS/Desktop/BIOINFO/PRBB/Training_Dataset/PAPER_dataset_creation/TRUE_DATASET/References/")

  grnas<- c("GGCCCAGACTGAGCACGTGA",  "GTCATCTTAGTCATTACCTG",  "GCATTTTCAGGAGGAAGCGA"  ,"GATGTCTGCAGGCCAGATGA",  "GGAATCCCTTCTGCAGCACC",  "GAGTCCGAGCAGAAGAAGAA","GATTCCTGGTGCCAGAAACA"  ,"GCATGGTGCACCTGACTCCTG", "GCAGTGGTGGGGGGCCTTGG") 
r1 <- "ATGTGGGCTGCCTAGAAAGGCATGGATGAGAGAAGCCTGGAGACAGGGATCCCAGGGAAACGCCCATGCAATTAGTCTATTTCTGCTGCAAGTAAGCATGCATTTGTAGGCTTGATGCTTTTTTTCTGCTTCTCCAGCCCTGGCCTGGGTCAATCCTTGGGGCCCAGACTGAGCACGTGATGGCAGAGGAAAGGAAGCCCTGCTTCCTCCAGAGGGCGTCGCAGGACAGCTTTTCCTAGACAGGGG"

r2 <- "ACGTCTCATATGCCCCTTGGCAGTCATCTTAGTCATTACCTGAGGTGTTCGTTGTAACTCATATAAACTGAGTTCCCATGTTTTGCTTAATGGTTGAGTTCCGTTTGTCTGCACAGCCTGAGACATTGCTGGAAATAAAGAAGAGAGAAAAACAATTTTAGTATTTGGAAGGGAAGTGCTATGGTCTGAATGTATGTGTCCCACCAAAATTCCTACGT"

r3 <- "TCACAAACAAGACAGGGAACTGGCAGGCACCGAGGCATCTCTGCACCGAGGTGAAACAAGCTGCCATTTCATTACAGGCAAAGCTGAGCAAAAGTAGATATTACAAGACCAGCATGTACTCACCTCTCATGAAGCACTGTGGGTACGAAGGAAATGACTCAAATATGCTGTCTGAAGCCATCGCTTCCTCCTGAAAATGCACCCTCTTCTGAAGGCGGGGGACTCAATGATTTCTTTTACCTTCGGAGCGAAAACCAAGACAGGTCACTGTTTC"

r4 <- "ACTTGGTGCCAAATTCTTCTCCCCTGGGAAGCATCCCTGGACACTTCCCAAAGGACCCCAGTCACTCCAGCCTGTTGGCTGCCGCTCACTTTGATGTCTGCAGGCCAGATGAGGGCTCCAGATGGCACATTGTCAGAGGGACACACTGTGGCCCCTGTGCCCAGCCCTGGGCTCTCTGTACATGAAGCAACTCCAGTCCCAAATATGTAGCTGTTTGGGAGGTCAGAAATAGGGGGTCCAGGAGCAAACTCCCCCCACCCCCTTTCCAAAGCCCAT"

r5 <- "TAGCATTGCAGAGAGGCGTATCATTTCGCGGATGTTCCAATCAGTACGCAGAGAGTCGCCGTCTCCAAGGTGAAAGCGGAAGTAGGGCCTTCGCGCACCTCATGGAATCCCTTCTGCAGCACCTGGATCGCTTTTCCGAGCTTCTGGCGGTCTCAAGCACTACCTACGTCAGCACCTGGGACCCC"

r6 <- "CAGCTCAGCCTGAGTGTTGAGGCCCCAGTGGCTGCTCTGGGGGCCTCCTGAGTTTCTCATCTGTGCCCCTCCCTCCCTGGCCCAGGTGAAGGTGTGGTTCCAGAACCGGAGGACAAAGTACAAACGGCAGAAGCTGGAGGAGGAAGGGCCTGAGTCCGAGCAGAAGAAGAAGGGCTCCCATCACATCAACCGGTGGCGCATTGCCACGAAGCAGGCCAATGGGGAGGACATCGATGTCACCTCCA"

r7 <- "CACAACAGCTTCATGTCAGCCAAGGCCACAAACACCATGTACCACACATGTGAACGGACAGATTGACATGTTAAAAACACAACATCAGTGCATGTTGGGGATTCCTGGTGCCAGAAACAGGGGTGACGGGAGGGCAGAACTAGTCCTTAGCAGCTTCCTCCTCCTTTATTTTAGCTGAAGGGAAATAAAAGGAAAAGTCACTCTGGGGAACACGCCCGGTGTCACGCCACTTGACAGGCGAGTAACAGACATGGACCATCAGGAAACATTAACGT"

r8 <- "AGGGTTGGCCAATCTACTCCCAGGAGCAGGGAGGGCAGGAGCCAGGGCTGGGCATAAAAGTCAGGGCAGAGCCATCTATTGCTTACATTTGCTTCTGACACAACTGTGTTCACTAGCAACCTCAAACAGACAcCATGGTGCAtCTGACTCCTGAgGAGAAGTCTGCCGTTACTGCCCTGTGGGGCAAGGTGAACGTGGATGAAGTTGGTGGTGAGGCCCTGGGCAGGTTGGTATCAAGGTTACA"

r9 <- "GTCAGTGGAACAAGCCGAGTAAGCCAAAAACCAACATGAAGCACATGGCTGGTGCTGCAGCAGCTGGGGCAGTGGTGGGGGGCCTTGGCGGCTACATGCTGGGAAGTGCCATGAGCAGGCCCATCATACATTTCGGCAGTGACTATGAGGACCGTTACTATCGTGAAAACATGCACCGTTACCCCAACCAAGT"
references <- c(r1,r2,r3,r4,r5,r6,r7,r8,r9)
for (i in 1:length(All_figures$Run)){
  ref <- toupper(references[which(toupper(All_figures$gRNA[i])==grnas)])
  write.fasta(as.string = T,sequences = ref, open = "w",names = All_figures$Run[i], file.out = paste(All_figures$Run[i],".fa",sep = ""))  
}
